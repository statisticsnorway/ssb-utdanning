---

title: Fellesfunksjoner for 360


keywords: fastai
sidebar: home_sidebar

summary: "En test for å se om fellesfunksjonene til hver seksjon kan organiseres som ett nbdev-prosjekt, med undermoduler per tema."
description: "En test for å se om fellesfunksjonene til hver seksjon kan organiseres som ett nbdev-prosjekt, med undermoduler per tema."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Denne siden fungerer både som readme for githubprosjektet, og forsiden av dokumentasjonen på <a href="https://statisticsnorway.github.io/ssb_fellesfunksjoner_360/">https://statisticsnorway.github.io/ssb_fellesfunksjoner_360/</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installering">Installering<a class="anchor-link" href="#Installering"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install ssb_fellesfunksjoner_360</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bruk-help()-p&#229;-modulene-for-&#229;-lese-integrert-dokumentasjon">Bruk help() p&#229; modulene for &#229; lese integrert dokumentasjon<a class="anchor-link" href="#Bruk-help()-p&#229;-modulene-for-&#229;-lese-integrert-dokumentasjon"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ssb_fellesfunksjoner_360</span> <span class="kn">import</span> <span class="n">klass</span><span class="p">,</span> <span class="n">sporre</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">klass</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on module ssb_fellesfunksjoner_360.klass in ssb_fellesfunksjoner_360:

NAME
    ssb_fellesfunksjoner_360.klass - # AUTOGENERATED! DO NOT EDIT! File to edit: 01_klass.ipynb (unless otherwise specified).

FUNCTIONS
    get_pandas(URL, level)
        Get pandas dataframe from the KLASS-API
        
        Parameters
        ----------
        URL : str 
        
            url to the API-endpoint you are interested in
        level : str 
        
            level of the json to convert, for example &#39;classificationItems&#39; or &#39;correspondenceMaps&#39;
        
        Returns
        -------
        pandas.DataFrame() 
        
            The returned json at the level requested, converted to a pandas dataframe
        
        Further Development
        -------
        Error catching when &#34;level&#34; is not found in the returned json, show the top level json-keys then?

DATA
    __all__ = [&#39;get_pandas&#39;]

FILE
    /home/jovyan/ssb_fellesfunksjoner_360/ssb_fellesfunksjoner_360/klass.py


</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">sporre</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on module ssb_fellesfunksjoner_360.sporre in ssb_fellesfunksjoner_360:

NAME
    ssb_fellesfunksjoner_360.sporre - # AUTOGENERATED! DO NOT EDIT! File to edit: 03_sporre.ipynb (unless otherwise specified).

FUNCTIONS
    avled_tverrvar(codeprefix, coderange, lettercodes, df)
        Denne funksjonen sjekker en bred range av kode-kolonner, og slår disse sammen til en oppsummeringskolonne.
        
        Forutsetningen er at det er lignende svaralternativer på ulike spørsmål som man skal gå gjennom og at de &#34;Or-es&#34;, dvs True på 1 er True på den avledete variabelen.
        
        F.eks. 17 spørsmål om fjernsynskanaler, hvor man spør etter 21 ulike programtyper. Og man ønsker å svare på: &#39;Så denne personen på denne typen program i det hele tatt?&#39;
        
        
        
        Parameters
        ----------
        first &#34;codeprefix&#34; : string
        
            Første parameter er en string som er prefikset til kolonnene, feks. &#39;fje10_&#39;
        second &#34;coderange&#34; : integer
        
            Andre parameter er ett tall som sier hvor mange kolonner som er nummerert.
            Om du sender 17 så vil den ta alle tallene som er 1-17 og da lage kolonneheadere som &#39;fje10_17x&#39;
        third &#34;lettercodes&#34; : dict
        
            Det tredje parameteret skal være en dict, som forteller om hvilket svaralternativ skal bli til hvilken nye kolonne.
            feks. &#39;a&#39; : &#39;tvsport&#39;, hvor svaralternativ &#39;a&#39; på alle kanaler, skal bli &#39;eller&#39;-t til en avledet variabelkolonne &#39;tvsport&#39;
        fourth &#34;df&#34; : Pandas Dataframe
        
            Det fjerde parameteret skal være dataframen som vi opererer på.
        
        Returns
        -------
        DataFrame
        
            Returnerer dataframen som kom inn, med ny avledet kolonne.
        
        Raises
        ------
        ValueError
        
            Om noen av variablene inn ikke stemmer med forventede typer.
            Om dataframen er 0 rader lang.
        KeyError
        
            Om noen av kolonnene det letes i, ikke finnes.
            Om noen av kolonnene som burde vært opprettet, ikke er der på slutten av funksjonen.

DATA
    __all__ = [&#39;avled_tverrvar&#39;]

FILE
    /home/jovyan/ssb_fellesfunksjoner_360/ssb_fellesfunksjoner_360/sporre.py


</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Hvordan-bruke-eksempelfunksjon">Hvordan bruke eksempelfunksjon<a class="anchor-link" href="#Hvordan-bruke-eksempelfunksjon"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Etter å ha importert modulen, så kan du feks bruke denne funksjonen for å hente noe fra KLASS-apiet som en pandas dataframe.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gjeld_fylke</span> <span class="o">=</span> <span class="n">klass</span><span class="o">.</span><span class="n">get_pandas</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;http://data.ssb.no/api/klass/v1/versions/1158&#39;</span><span class="p">,</span> <span class="s1">&#39;classificationItems&#39;</span><span class="p">)</span>
<span class="n">gjeld_fylke</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">JSONDecodeError</span>                           Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-4-45f864010e24&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>gjeld_fylke <span class="ansi-blue-fg">=</span> klass<span class="ansi-blue-fg">.</span>get_pandas<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">r&#39;http://data.ssb.no/api/klass/v1/versions/1158&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;classificationItems&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> gjeld_fylke

<span class="ansi-green-fg">~/ssb_fellesfunksjoner_360/ssb_fellesfunksjoner_360/klass.py</span> in <span class="ansi-cyan-fg">get_pandas</span><span class="ansi-blue-fg">(URL, level)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span>     r <span class="ansi-blue-fg">=</span> requests<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>URL<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     34</span>     r <span class="ansi-blue-fg">=</span> r<span class="ansi-blue-fg">.</span>content<span class="ansi-blue-fg">.</span>decode<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;utf8&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>replace<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;&#39;&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;&#34;&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 35</span><span class="ansi-red-fg">     </span>r <span class="ansi-blue-fg">=</span> json<span class="ansi-blue-fg">.</span>loads<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     36</span>     r <span class="ansi-blue-fg">=</span> pd<span class="ansi-blue-fg">.</span>json_normalize<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">[</span>level<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span>     <span class="ansi-green-fg">return</span> r

<span class="ansi-green-fg">/opt/conda/lib/python3.8/json/__init__.py</span> in <span class="ansi-cyan-fg">loads</span><span class="ansi-blue-fg">(s, cls, object_hook, parse_float, parse_int, parse_constant, object_pairs_hook, **kw)</span>
<span class="ansi-green-intense-fg ansi-bold">    355</span>             parse_int <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> parse_float <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span>
<span class="ansi-green-intense-fg ansi-bold">    356</span>             parse_constant is None and object_pairs_hook is None and not kw):
<span class="ansi-green-fg">--&gt; 357</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> _default_decoder<span class="ansi-blue-fg">.</span>decode<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    358</span>     <span class="ansi-green-fg">if</span> cls <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    359</span>         cls <span class="ansi-blue-fg">=</span> JSONDecoder

<span class="ansi-green-fg">/opt/conda/lib/python3.8/json/decoder.py</span> in <span class="ansi-cyan-fg">decode</span><span class="ansi-blue-fg">(self, s, _w)</span>
<span class="ansi-green-intense-fg ansi-bold">    335</span> 
<span class="ansi-green-intense-fg ansi-bold">    336</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 337</span><span class="ansi-red-fg">         </span>obj<span class="ansi-blue-fg">,</span> end <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>raw_decode<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">,</span> idx<span class="ansi-blue-fg">=</span>_w<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>end<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    338</span>         end <span class="ansi-blue-fg">=</span> _w<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">,</span> end<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>end<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    339</span>         <span class="ansi-green-fg">if</span> end <span class="ansi-blue-fg">!=</span> len<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/json/decoder.py</span> in <span class="ansi-cyan-fg">raw_decode</span><span class="ansi-blue-fg">(self, s, idx)</span>
<span class="ansi-green-intense-fg ansi-bold">    351</span>         &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    352</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 353</span><span class="ansi-red-fg">             </span>obj<span class="ansi-blue-fg">,</span> end <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>scan_once<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">,</span> idx<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    354</span>         <span class="ansi-green-fg">except</span> StopIteration <span class="ansi-green-fg">as</span> err<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    355</span>             <span class="ansi-green-fg">raise</span> JSONDecodeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Expecting value&#34;</span><span class="ansi-blue-fg">,</span> s<span class="ansi-blue-fg">,</span> err<span class="ansi-blue-fg">.</span>value<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">from</span> <span class="ansi-green-fg">None</span>

<span class="ansi-red-fg">JSONDecodeError</span>: Expecting &#39;,&#39; delimiter: line 1 column 5660 (char 5659)</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

